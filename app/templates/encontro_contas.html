{% extends "app/base.html" %} {% block title %}Encontro de Contas - Compras
Executivo{% endblock %} {% block content %}

<div class="container-fluid">
    <!-- Breadcrumb Component - Dynamic -->
    <div id="encontro-contas-breadcrumb-dynamic-container">
        <!-- Breadcrumb será carregado dinamicamente via JavaScript -->
    </div>

    <!-- Topico Component - Dynamic -->
    <div id="encontro-contas-topico-container">
        <!-- Topico será carregado dinamicamente via JavaScript -->
    </div>

    <!-- Main Content -->
    <div id="encontro-contas-content-metodos-eficiencia" class="encontro-contas-three-cards">
        <!-- Main Content Layout -->
        <div class="row">
            <!-- Card 1 - Empenhos -->
            <div class="col-xl-4 col-lg-4 col-md-6 col-12 mb-2">
                <div class="encontro-contas-content">
                    <div class="sidebar-card">
                        <!-- Card Header Component - Dynamic -->
                        <div id="encontro-contas-empenhos-header">
                            <!-- Card header será carregado dinamicamente via JavaScript -->
                        </div>

                        <div class="card-body-govbr">
                            <!-- Content for Card 1 -->
                            <div class="encontro-contas-card-content" id="encontroContasEmpenhosContent">
                                <!-- Conteúdo será carregado dinamicamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 2 - Valores Totais -->
            <div class="col-xl-4 col-lg-4 col-md-6 col-12 mb-2">
                <div class="encontro-contas-content">
                    <div class="sidebar-card">
                        <!-- Card Header Component - Dynamic -->
                        <div id="encontro-contas-valores-header">
                            <!-- Card header será carregado dinamicamente via JavaScript -->
                        </div>

                        <div class="card-body-govbr">
                            <!-- Content for Card 2 -->
                            <div class="encontro-contas-card-content" id="encontroContasValoresContent">
                                <!-- Conteúdo será carregado dinamicamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 3 - Últimos Lançamentos -->
            <div class="col-xl-4 col-lg-4 col-md-6 col-12 mb-2">
                <div class="encontro-contas-content">
                    <div class="sidebar-card">
                        <!-- Card Header Component - Dynamic -->
                        <div id="encontro-contas-lancamentos-header">
                            <!-- Card header será carregado dinamicamente via JavaScript -->
                        </div>

                        <div class="card-body-govbr">
                            <!-- Content for Card 3 -->
                            <div class="encontro-contas-card-content" id="encontroContasLancamentosContent">
                                <!-- Conteúdo será carregado dinamicamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Topico Component - Movimentações Financeiras - Dynamic -->
    <div id="encontro-contas-movimentacoes-topico-container">
        <!-- Topico será carregado dinamicamente via JavaScript -->
    </div>

    <!-- Full-width 12-col chart container above the empenhos list -->
    <div class="col-12 mb-4">
        <div id="grafico-financeiro-container" style="width: 100%; height: 300px"></div>
    </div>

    <!-- GRIDS -->
    <div id="encontro-contas-content-empenhos" class="encontro-contas-empenhos-section">
        <!-- Layout especial: Card 1 à esquerda (400px), Cards 2 e 3 empilhados à direita (200px cada) -->
        <div class="encontro-contas-empenhos-layout">
            <!-- Card 1 - Empenhos Originais (Esquerda - 400px height) -->
            <div class="encontro-contas-empenhos-left">
                <div class="encontro-contas-content">
                    <div class="sidebar-card">
                        <!-- Card Header Component - Dynamic -->
                        <div id="encontro-contas-empenho-originais-header">
                            <!-- Card header será carregado dinamicamente via JavaScript -->
                        </div>

                        <div class="card-body-govbr"> 
                            <!-- Content for Card 1 -->
                            <div class="encontro-contas-card-content" id="encontroContasEmpenhoOriginaisContent">
                                <!-- Conteúdo será carregado dinamicamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cards 2 e 3 empilhados na direita -->
            <div class="encontro-contas-empenhos-right">
                <!-- Card 2 - Orçamentário (200px height) -->
                <div class="encontro-contas-empenhos-right-top">
                    <div class="encontro-contas-content">
                        <div class="sidebar-card">
                            <!-- Card Header Component - Dynamic -->
                            <div id="encontro-contas-empenho-orcamentario-header">
                                <!-- Card header será carregado dinamicamente via JavaScript -->
                            </div>

                            <div class="card-body-govbr">
                                <!-- Content for Card 2 -->
                                <div class="encontro-contas-card-content" id="encontroContasEmpenhoOrcamentarioContent">
                                    <!-- Conteúdo será carregado dinamicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 3 - Financeiro (200px height) -->
                <div class="encontro-contas-empenhos-right-bottom">
                    <div class="encontro-contas-content">
                        <div class="sidebar-card">
                            <!-- Card Header Component - Dynamic -->
                            <div id="encontro-contas-empenho-financeiro-header">
                                <!-- Card header será carregado dinamicamente via JavaScript -->
                            </div>

                            <div class="card-body-govbr">
                                <!-- Content for Card 3 -->
                                <div class="encontro-contas-card-content" id="encontroContasEmpenhoFinanceiroContent">
                                    <!-- Conteúdo será carregado dinamicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Empenhos Originais Section with Grid Financeiro and Movimentações -->
    <div class="row mb-4 encontro-cards-row">
        <!-- Empenhos Originais - Left side (col-lg-8) -->
        <div class="col-lg-8">
            <div class="br-card" id="empenhos-originais-container" style="height: 500px">
                <div class="card-header">
                    <div class="d-flex align-items-center justify-content-between">
                        <div class="d-flex" style="width: 100%">
                            <div class="ml-3" style="flex-grow: 1">
                                <div class="titulo">
                                    <img src="/static/images/doc2.png" alt="Ícone"
                                        style="height: 36px; margin: 10px 0px -10px 0px" />
                                    Empenhos Originais
                                </div>
                                <div style="
                    border-bottom: 1px solid #ccc;
                    margin: -6px 0px 0px 26px;
                  "></div>
                                <div class="subtitulo">
                                    Lista numerada de empenhos do contrato
                                </div>
                            </div>
                        </div>
                        <div class="d-flex align-items-center gap-2" style="margin-top: -18px"></div>
                    </div>
                </div>
                <div class="card-content" style="padding: 20px; height: calc(100% - 80px); overflow-y: auto; display: flex; align-items: center; justify-content: center;">
                    <div class="text-muted text-center">
                        <i class="fas fa-arrow-up fa-2x mb-3"></i>
                        <br />
                        <strong>Tabela de Empenhos movida para o card acima</strong>
                        <br />
                        <small>A tabela interativa agora está no card "Empenhos Originais" na seção superior</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right side - Grid Financeiro and Movimentações stacked (col-lg-4) -->
        <div class="col-lg-4">
            <div class="encontro-right-column">
                <!-- Movimentações Orçamentárias Section -->
                <div class="mb-4">
                    <div class="br-card" id="movimentacoes-container" style="height: 240px">
                        <div class="card-header">
                            <div class="d-flex align-items-center justify-content-between">
                                <div class="d-flex" style="width: 100%">
                                    <div class="ml-3" style="flex-grow: 1">
                                        <div class="titulo">
                                            <img src="/static/images/doc2.png" alt="Ícone"
                                                style="height: 36px; margin: 10px 0px -10px 0px" />
                                            Orçamentário
                                        </div>
                                        <div style="
                        border-bottom: 1px solid #ccc;
                        margin: -6px 0px 0px 26px;
                      "></div>
                                        <div class="subtitulo">
                                            Lista de movimentações orçamentárias do contrato
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-content" style="padding: 0; height: calc(100% - 80px); overflow-y: auto">
                            <div class="table-responsive">
                                <table class="br-table table-hover table-striped">
                                    <thead style="background-color: #f8f8f8">
                                        <tr>
                                            <th style="width: 40px; border: none">#</th>
                                            <th style="border: none">Data</th>
                                            <th style="border: none">Empenho</th>
                                            <th style="width: 50px; border: none"></th>
                                            <th style="border: none">Espécie</th>
                                            <th style="border: none">Valor</th>
                                        </tr>
                                    </thead>
                                    <tbody id="movimentacoes-tbody">
                                        <!-- Loading state -->
                                        <tr>
                                            <td colspan="6" class="text-center" style="padding: 40px">
                                                <div class="text-muted">
                                                    <i class="fas fa-exchange-alt fa-2x mb-3"></i>
                                                    <br />
                                                    Dados de movimentações carregados automaticamente
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grid Numerado Financeiro Section -->
                <div>
                    <div class="br-card" id="financeiro-grid-container" style="height: 240px">
                        <div class="card-header">
                            <div class="d-flex align-items-center justify-content-between">
                                <div class="d-flex" style="width: 100%">
                                    <div class="ml-3" style="flex-grow: 1">
                                        <div class="titulo">
                                            <img src="/static/images/doc2.png" alt="Ícone"
                                                style="height: 36px; margin: 10px 0px -10px 0px" />
                                            Financeiro
                                        </div>
                                        <div style="
                        border-bottom: 1px solid #ccc;
                        margin: -6px 0px 0px 26px;
                      "></div>
                                        <div class="subtitulo">
                                            Pagamentos e movimentações financeiras do contrato
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-content" style="padding: 0; height: calc(100% - 80px); overflow-y: auto">
                            <div class="table-responsive">
                                <table class="br-table table-hover table-striped">
                                    <thead style="background-color: #f8f8f8">
                                        <tr>
                                            <th style="width: 40px; border: none">#</th>
                                            <th style="border: none">Data</th>
                                            <th style="border: none">Pagamento</th>
                                            <th style="width: 50px; border: none"></th>
                                            <th style="border: none">Tipo</th>
                                            <th style="border: none">Parcial</th>
                                            <th style="border: none">Nominal</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financeiro-grid-tbody">
                                        <!-- Loading state -->
                                        <tr>
                                            <td colspan="8" class="text-center" style="padding: 40px">
                                                <div class="text-muted">
                                                    <i class="fas fa-coins fa-2x mb-3"></i>
                                                    <br />
                                                    Dados financeiros carregados automaticamente
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- The DetalhesEmpenhos functionality is now integrated into encontro_contas.js -->
    <!-- No additional script needed here as it's initialized with the main controller -->
</div>

<script type="module">
    // O módulo encontroContas agora é carregado automaticamente via app.js
    // e se auto-inicializa quando detecta que está na página correta
    console.log("📋 Encontro de Contas page loaded - waiting for auto-initialization...");
</script>
{% endblock %}